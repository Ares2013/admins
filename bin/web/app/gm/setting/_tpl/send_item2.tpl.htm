<?php $this->setLayout('amazeui');?>

<?php $this->block('title');?>指定玩家发送物品<?php $this->endBlock('title');?>

<?php $this->block('buttons');?>
<?php echo Game::platformsServersForm($platformid, $serverid);?>
<?php $this->endBlock('buttons');?>

<?php $this->block('content');?>

<form id="mainForm" method="post" class="am-form">
    <!-- panel start -->
    <div class="am-panel am-panel-default">
      <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-search'}">添加礼包<span class="am-icon-chevron-down am-fr" ></span></div>
      <div class="am-panel-bd am-collapse am-in" id="collapse-panel-search">

          <div class="am-g am-margin-vertical-sm">

              <div class="am-u-sm-12 am-u-md-2">
                  <div class="am-form-group">
                      <label for="log_type" class="am-text-sm">发送类型：</label>
                      <?php echo $logTypes; ?>
                  </div>
              </div>

              <div class="am-u-sm-12 am-u-md-4">
                  <div class="am-form-group">
                      <label for="level_start" class="am-text-sm">多个ID或名字请用英文逗号隔开：</label>
                      <input type="text" name="player_id" value="<?php echo $this->input['id']; ?>" class="am-form-field am-input-sm" placeholder="玩家ID或名字" required/>
                  </div>
              </div>

              <div class="am-u-sm-12 am-u-md-12">
                  <div class="am-form-group">
                      <label for="reason" class="am-text-sm">发送理由：</label>
                      <input name="data[reason]" value="" class="am-form-field am-input-sm" placeholder="" required/>
                  </div>
              </div>

              <div class="am-u-sm-12 am-u-md-12">
                  <div class="am-form-group">
                      <button onclick="add_input_yb();" class="am-btn am-btn-default am-input-sm" type="button">+元宝</button>
                      <button onclick="add_input_lj();" class="am-btn am-btn-default am-input-sm" type="button">+礼金</button>
                      <button onclick="add_input_coin();" class="am-btn am-btn-default am-input-sm" type="button">+银两</button>
                      <button onclick="add_input_item();" class="am-btn am-btn-default am-input-sm" type="button">+物品</button>
                  </div>
              </div>

          </div>

          <div class="am-g am-margin-vertical-sm" id='input-elements'>
          </div>

          <div class="am-g am-margin-vertical-sm">

              <div class="am-u-sm-12 am-u-md-2 am-u-end">
                  <button class="am-btn am-btn-primary am-input-sm" type="submit">发送</button>
              </div>

          </div>

      </div>
    </div>
    <!-- panel end -->



<div class="am-cf">
    <div class="am-fr">
      <ul class="am-pagination">
        <?php //echo $data['page_index']?>
      </ul>
    </div>
</div>


</form>

<script type="text/javascript" src="assets/js/data_items.js"></script>
<script>
function add_input_yb(){

    if($("#element-yb").length){
        $("#element-yb").focus();
        return false;
    }
    var html = '';
    html += '<div class="am-u-sm-12 am-u-md-3 am-u-end">';
    html += '    <div class="am-alert am-alert-secondary" data-am-alert>';
    html += '        <button type="button" class="am-close">&times;</button>';
    html += '        <label for="gift_name" class="am-text-sm">元宝：</label>';
    html += '        <input type="number" id="element-yb" name="item[ext][1]" value="" class="am-form-field am-input-sm" required/>';
    html += '    </div>';
    html += '</div>';
    $("#input-elements").append(html);
    return true;

}

function add_input_lj(){

    if($("#element-lj").length){
        $("#element-lj").focus();
        return false;
    }
    var html = '';
    html += '<div class="am-u-sm-12 am-u-md-3 am-u-end">';
    html += '    <div class="am-alert am-alert-secondary" data-am-alert>';
    html += '        <button type="button" class="am-close">&times;</button>';
    html += '        <label for="gift_name" class="am-text-sm">礼金：</label>';
    html += '        <input type="number" id="element-lj" name="item[ext][2]" value="" class="am-form-field am-input-sm" required/>';
    html += '    </div>';
    html += '</div>';
    $("#input-elements").append(html);
    return true;

}

function add_input_coin(){

    if($("#element-coin").length){
        $("#element-coin").focus();
        return false;
    }
    var html = '';
    html += '<div class="am-u-sm-12 am-u-md-3 am-u-end">';
    html += '    <div class="am-alert am-alert-secondary" data-am-alert>';
    html += '        <button type="button" class="am-close">&times;</button>';
    html += '        <label for="gift_name" class="am-text-sm">银两：</label>';
    html += '        <input type="number" id="element-coin" name="item[ext][3]" value="" class="am-form-field am-input-sm" required/>';
    html += '    </div>';
    html += '</div>';
    $("#input-elements").append(html);
    return true;

}

function add_input_item(){
    var index = $(".element-item").length;//添加的物品框编号
    var id = "element-item-"+index;
    var html = '';
    html += '<div class="am-u-sm-12 am-u-md-3 am-u-end">';
    html += '    <div class="am-alert am-alert-secondary" data-am-alert>';
    html += '        <button type="button" class="am-close">&times;</button>';
    html += '        <label for="gift_name" class="am-text-sm">物品：</label>';
    html += '            <div class="am-g">';
    html += '                <div class="am-u-sm-7">';
    html += '                        <input type="text" name="item[goods]['+index+'][id]" value="" class="am-input-sm element-item" required placeholder="物品ID" id="'+id+'"/>';
    html += '                </div>';
    html += '                <div class="am-u-sm-5">';
    html += '                        <input type="number" name="item[goods]['+index+'][num]" value="" class="am-input-sm" required placeholder="数量"/>';
    html += '                </div>';
    html += '            </div>';
    html += '    </div>';
    html += '</div>';
    $("#input-elements").append(html);


    var items = data_items;

    $( "#"+id ).autocomplete({
        source: items,
        close: function( event, ui ) {
            var o = $("#"+id).val();
            var i = o.indexOf(" ")
            if(i > 0){
                var v = o.substr(0, i);
                $("#"+id).val(v);
            }
        }
    });

    return true;

}

function sel() {
    if($("#select-all").prop("checked")){
        $(".server-checkbox").prop("checked", true);
    }else{
        $(".server-checkbox").prop("checked", false);
    }
}

$(function() {

    var startDate = new Date(2000, 1, 1);
    var endDate = new Date(2099, 11, 25);
    var $alert = $('#my-alert');

    $('#login-time-icon').datepicker().
    on('changeDate.datepicker.amui', function(event) {
        $alert.hide();
        startDate = new Date(event.date);
        $('#login-time').val($('#login-time-icon').data('date') + ' 00:00:00');
        $(this).datepicker('close');
    });

});
</script>
<?php $this->endBlock('content');?>
