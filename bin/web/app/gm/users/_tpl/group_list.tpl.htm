<?php $this->setLayout('amazeui');?>

<?php $this->block('title');?><?php echo $_GET['kw']['title'] ? $_GET['kw']['title']:'' ?>用户组列表<?php $this->endBlock('title');?>

<?php $this->block('buttons');?>
<button class="am-btn am-btn-default am-input-sm" onclick="location.replace('?mod=users&act=group_edit');" type="button">添加用户组</button>
<?php $this->endBlock('buttons');?>

<?php $this->block('content');?>
<form id="mainForm" method="get" action="<?php echo request_uri(); ?>" class="am-form">
  <table class="am-table am-table-striped am-table-hover">
    <thead>
      <tr>
          <th class="am-text-nowrap table-title">组名称</th>
          <th class="am-text-nowrap">权限</th>
          <th class="am-text-nowrap table-set">操作</th>
      </tr>
  </thead>
  <tbody>
           <?php foreach($data['list'] as $v): ?>
           <tr>
               <td class="am-text-middle table-title"><?php echo $v['name']?></td>
               <td class="am-text-middle"><?php echo $v['menu']?></td>
               <td class="am-text-middle">
                   <a href="?mod=users&act=group_edit&do=edit&id=<?php echo $v['id']?>">编辑</a> <a onclick="return confirm('确认要删除吗？');" href="?mod=users&act=group_list&do=del&id=<?php echo $v['id']?>">删除</a>
               </td>
           </tr>
           <?php endforeach;?>
  </tbody>
</table>
<hr>

<div class="am-cf">
    <div class="am-fr">
      <ul class="am-pagination">
        <?php echo $data['page_index']?>
      </ul>
    </div>
</div>


</form>

<!-- 侧边栏内容 -->
<div id="op-offcanvas" class="am-offcanvas">
  <div class="am-offcanvas-bar am-offcanvas-bar-flip">
    <div class="am-offcanvas-content">
      <p id="op-name"> </p>
      <p id="op-links"> </p>
      <button class="am-btn am-btn-primary op-oc-js am-btn-xs am-btn-block am-round" data-rel="close">关闭</button>
    </div>
  </div>
</div>

<div class="am-popup" id="op-popup">
  <div class="am-popup-inner">
    <div class="am-popup-hd">
      <h4 class="am-popup-title" id="op-popup-title"></h4>
      <span data-am-modal-close class="am-close am-close-alt">&times;</span>
    </div>
    <div class="am-popup-bd" id="op-popup-content">
    </div>
  </div>
</div>

<script>
$(function() {

    var $modal = $('#op-popup');

    $('td, #op-offcanvas').on('click', '.op-modal-open-js', function() {
        var name = $("#op-name").html();
        var url = $(this).data('url');
        var actionName = $(this).html();
        $('#op-popup-title').html(actionName + "： " + name);
        $modal.modal();
        $.get(url, function(result){
            $('#op-popup-content').html(result);
        });
    }).on('click', '.op-page-js', function() {
        var url = $(this).data('url');
        windowOpen(url, '_self');
    }).on('click', '.op-new-page-js', function() {
        var url = $(this).data('url');
        windowOpen(url, '_blank');
    });

});
</script>
<?php $this->endBlock('content');?>
