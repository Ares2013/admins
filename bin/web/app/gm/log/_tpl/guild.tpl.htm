<?php $this->setLayout('amazeui');?>

<?php $this->block('title');?>
帮派查询
<?php $this->endBlock('title');?>

<?php $this->block('buttons');?>
<?php echo Game::platformsServersForm($platformid, $serverid);?>
<?php $this->endBlock('buttons');?>

<?php $this->block('content');?>
<form id="mainForm" method="get" action="<?php echo request_uri(); ?>" class="am-form">
    <!-- 使搜索的时候获取当前的mod=role&act=list 按搜索角色id时停止继续加上前面的url内容    按分页时停止继续加之前的url内容 -->
    <?php foreach($_GET as $k => $v):?>
    <?php if($k == 'kw') continue;?>
    <?php if($k == 'page') continue;?>  
    <input type="hidden" name="<?php echo $k;?>" value="<?php echo $v;?>" />
    <?php endforeach;?>

    <table class="am-table am-table-striped am-table-compact am-text-xs am-table-hover">
        <thead>
            <tr>
                <th>帮派ID</th>
                <th>帮派名称</th>
                <th>帮主ID</th>
                <th>等级</th> 
                <th>创建时间</th>
                <th>帮派成员数</th>
                <th>操作</th>

            </tr>
        </thead>
        <tbody>
        <?php
        foreach($data['list'] as $v):

        ?>
        <tr>       
            <td class="am-hide-md-down am-text-middle"><?php echo $v['guild_id'] ?></td>
            <td class="am-text-middle am-hide-sm-only"><?php echo $v['name'] ?></td>
            <td class="am-text-middle"><?php echo Game::getName($v['header_id'], $serverid, $platformid);?></td>
            <td class="am-text-middle am-hide-sm-only"><?php echo $v['level'];?></td>
            <td class="am-text-middle"><?php echo date('Y-m-d H:i:s', $v['ctime']);?></td>
            <td class="am-text-middle am-hide-sm-only"><?php echo count(explode(',', $v['member']));?></td>
            <td class="am-text-middle am-hide-sm-only"><a href="?mod=role&act=list&kw[playerids]=<?php echo $v['member'];?>">查看帮派成员</a></td>
        </tr>
        <?php endforeach;?>
        </tbody>
    </table>

    <div class="am-cf">
        <div class="am-fr">
            <ul class="am-pagination">
                <?php echo $data['page_index']?>
            </ul>
        </div>
    </div>


</form>

<script>

$(function() {

        var startDate = new Date(2000, 1, 1);
        var endDate = new Date(2099, 11, 25);
        var $alert = $('#my-alert');

        $('#date-start-icon').datepicker().
        on('changeDate.datepicker.amui', function(event) {
            if (event.date.valueOf() > endDate.valueOf()) {
            $alert.find('p').text('开始日期应小于结束日期！').end().show();
            } else {
            $alert.hide();
            startDate = new Date(event.date);
            $('#date-start').val($('#date-start-icon').data('date') + ' 00:00:00');
            }
            $(this).datepicker('close');
            });

        $('#date-end-icon').datepicker().
        on('changeDate.datepicker.amui', function(event) {
            if (event.date.valueOf() < startDate.valueOf()) {
            $alert.find('p').text('结束日期应大于开始日期！').end().show();
            } else {
            $alert.hide();
            endDate = new Date(event.date);
            $('#date-end').val($('#date-end-icon').data('date') + ' 23:59:59');
            }
            $(this).datepicker('close');
            });



});
</script>  

<?php $this->endBlock('content');?>


